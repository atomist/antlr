<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@atomist/antlr</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@atomist/antlr</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> @atomist/antlr</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<h1 id="-atomist-antlr">@atomist/antlr</h1>
				<p><a href="https://app.atomist.com/workspace/T29E48P34"><img src="http://badge.atomist.com/T29E48P34/atomist/antlr-ts/93a238be-3c16-456e-be12-76234a0caca5" alt="atomist sdm goals"></a>
				<a href="https://www.npmjs.com/package/@atomist/antlr"><img src="https://img.shields.io/npm/v/@atomist/antlr.svg" alt="npm version"></a></p>
				<p>Integration with <a href="https://github.com/tunnelvisionlabs/antlr4ts">ANTLR for TypeScript</a> for Atomist automation <a href="https://github.com/atomist/automation-client-ts">clients</a>.</p>
				<p>ANTLR is a powerful parser generator, for which many grammars are available.</p>
				<p>This enables running path expressions against ANTLR ASTs in
				a consistent manner to ASTs produced by other grammars.</p>
				<p>Includes Java support, in the <code>JavaFileParser</code> implementation of <code>FileParser</code>,
					as an example, test and for actual Java support, as well as Kotlin support,
					to show how to handle a grammar with a distinct lexer and parser.
					Other ANTLR grammars can be integrated with Atomist
				using this project as library, including offering an update model producing clean diffs.</p>
				<p>See <a href="https://github.com/atomist/automation-client-ts/blob/master/docs/PathExpressions.md">overall path expression documentation</a>.</p>
				<h2 id="usage">Usage</h2>
				<p>First, create an instance of a <code>FileParser</code> or <code>FileParserRegistry</code>.</p>
				<p>A <code>FileParser</code> knows how to parse files using a single grammar: for example, <code>MicrogrammarBasedFileParser</code> (from automation client) that uses a single microgrammar, or <code>JavaFileParser</code> from this project. A <code>FileParserRegistry</code> can accommodate multiple <code>FileParser</code> instances, determining whichever is appropriate to execute a given path expression.</p>
				<p>Then use the <code>findMatches</code> method in <code>astUtils</code>, which has the following signature:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findMatches</span>(<span class="hljs-params">p: ProjectNonBlocking,
                            globPattern: <span class="hljs-built_in">string</span>,
                            parserOrRegistry: FileParser | FileParserRegistry,
                            pathExpression: <span class="hljs-built_in">string</span> | PathExpression</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">TreeNode</span>[]&gt; </span>{</code></pre>
				<p>The following example looks in all Java files in a project for a given path expression:</p>
				<pre><code class="language-typescript">findMatches(project, JavaFiles, JavaFileParser,
    <span class="hljs-string">"//variableDeclaratorId/Identifier"</span>)
    .then(<span class="hljs-function"><span class="hljs-params">matches</span> =&gt;</span> {
        ...
</code></pre>
				<p>Returned matches are updatable after project flushing.</p>
				<h2 id="spi-supporting-other-antlr-grammars">SPI: Supporting other ANTLR grammars</h2>
				<p>This project includes support for parsing Java using the <a href="../src/tree/ast/antlr/java/Java.g4">Java ANTLR grammar</a>.</p>
				<p>There are <a href="https://github.com/antlr/grammars-v4">many available ANTLR grammars</a>, and the same approach can be used with most of them, making it possible to work with their ASTs in a consistent manner with Atomist.</p>
				<p>To add support for another grammar, perform the following steps:</p>
				<h3 id="generate-typescript">Generate TypeScript</h3>
				<p>Use the ANTLR CLI to generate the necessary files from the grammar.
				It is installed as a development dependency of this project.</p>
				<p>If your grammar has a separate lexer, first generate the TypeScript
				for that.  In this example, we&#39;ll use the Kotlin grammar.</p>
				<pre><code>$ ./node_modules/.bin/antlr4ts -visitor <span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">tree</span>/<span class="hljs-title">ast</span>/<span class="hljs-title">antlr</span>/<span class="hljs-title">kotlin</span>/<span class="hljs-title">KotlinLexer</span>.<span class="hljs-title">g4</span></span></code></pre><p>Then generate the TypeScript for the parser.</p>
				<pre><code>$ ./node_modules/.bin/antlr4ts -<span class="hljs-class"><span class="hljs-keyword">lib</span> <span class="hljs-title">lib</span>/<span class="hljs-title">tree</span>/<span class="hljs-title">ast</span>/<span class="hljs-title">antlr</span>/<span class="hljs-title">kotlin</span> -<span class="hljs-title">visitor</span> <span class="hljs-title">lib</span>/<span class="hljs-title">tree</span>/<span class="hljs-title">ast</span>/<span class="hljs-title">antlr</span>/<span class="hljs-title">kotlin</span>/<span class="hljs-title">KotlinParser</span>.<span class="hljs-title">g4</span></span></code></pre><p>You may need to reorder some of the generated code to eliminate forward references to ensure compilation.
				In your <code>antlr-gen/XXXXParser</code> file, reorder to put all classes <em>before</em> the <code>XXXXParser</code> class.</p>
				<p>If you are using <code>tslint</code> you may need to disable it for the generated sources as
				in this project.</p>
				<p>Note that antlr4ts is written in Java, and <code>npm</code> only wraps it, so
					you&#39;ll need a recent JVM. A JVM is <em>not</em> needed to execute the resulting
					grammar, which is pure TypeScript. Documentation for the ANTLR CLI is
				<a href="https://github.com/antlr/antlr4/blob/master/doc/tool-options.md">here</a>.</p>
				<h3 id="create-a-fileparser-implementation-to-integrate-your-grammar-with-your-atomist-automation-client">Create a FileParser Implementation to Integrate your Grammar with your Atomist Automation Client</h3>
				<p>Create an instance of <code>FileParser</code> to work with your grammar. Use <code>TreeBuildingListener</code> to do the work of building an Atomist <code>TreeNode</code> from the ANTLR parse tree.</p>
				<p>Create your <code>FileParser</code> in the style of <code>JavaFileParser</code> in this project,
				passing the top level production name and the lexer and parser classes.</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> JavaFileParser = <span class="hljs-keyword">new</span> AntlrFileParser(<span class="hljs-string">"compilationUnit"</span>, JavaLexer, JavaParser);</code></pre>
				<p>If your grammar uses Java or other code you may need to port that code to JavaScript or TypeScript.
					Please refer to ANTLR documentation in this case.
					Please validate your grammar with an IDE plugin or other tool before generating code and attempting
				integration.</p>
				<h2 id="support">Support</h2>
				<p>General support questions should be discussed in the <code>#support</code>
				channel in the <a href="https://join.atomist.com/" title="Atomist Community Slack">Atomist community Slack workspace</a>.</p>
				<p>If you find a problem, please create an <a href="https://github.com/atomist/antlr-ts/issues">issue</a>.</p>
				<h2 id="development">Development</h2>
				<p>You will need to install <a href="https://nodejs.org/" title="Node.js">Node.js</a> to build and test this
				project.</p>
				<h3 id="build-and-test">Build and test</h3>
				<p>Install dependencies.</p>
				<pre><code>$ npm <span class="hljs-keyword">install</span></code></pre><p>Use the <code>build</code> package script to compile, test, lint, and build the
				documentation.</p>
				<pre><code>$ npm <span class="hljs-keyword">run</span><span class="bash"> build</span></code></pre><h3 id="release">Release</h3>
				<p>Releases are handled via the <a href="https://github.com/atomist/atomist-sdm" title="Atomist Software Delivery Machine">Atomist SDM</a>.  Just press
				the &#39;Approve&#39; button in the Atomist dashboard or Slack.</p>
				<hr>
				<p>Created by <a href="https://atomist.com/" title="Atomist - How Teams Deliver Software">Atomist</a>.
				Need Help?  <a href="https://join.atomist.com/" title="Atomist Community Slack">Join our Slack workspace</a>.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_index_.html">"index"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_antlrfileparser_.html">"lib/tree/ast/antlr/<wbr>Antlr<wbr>File<wbr>Parser"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_treebuildinglistener_.html">"lib/tree/ast/antlr/<wbr>Tree<wbr>Building<wbr>Listener"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_javafileparser_.html">"lib/tree/ast/antlr/java/<wbr>Java<wbr>File<wbr>Parser"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_java9lexer_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java9<wbr>Lexer"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_java9listener_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java9<wbr>Listener"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_java9parser_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java9<wbr>Parser"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_java9visitor_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java9<wbr>Visitor"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_javalexer_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java<wbr>Lexer"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_javalistener_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java<wbr>Listener"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_javaparser_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java<wbr>Parser"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_java_antlr_gen_javavisitor_.html">"lib/tree/ast/antlr/java/antlr-<wbr>gen/<wbr>Java<wbr>Visitor"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_kotlin_kotlinfileparser_.html">"lib/tree/ast/antlr/kotlin/<wbr>Kotlin<wbr>File<wbr>Parser"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_kotlin_antlr_gen_kotlinlexer_.html">"lib/tree/ast/antlr/kotlin/antlr-<wbr>gen/<wbr>Kotlin<wbr>Lexer"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_kotlin_antlr_gen_kotlinparser_.html">"lib/tree/ast/antlr/kotlin/antlr-<wbr>gen/<wbr>Kotlin<wbr>Parser"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_kotlin_antlr_gen_kotlinparserlistener_.html">"lib/tree/ast/antlr/kotlin/antlr-<wbr>gen/<wbr>Kotlin<wbr>Parser<wbr>Listener"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_lib_tree_ast_antlr_kotlin_antlr_gen_kotlinparservisitor_.html">"lib/tree/ast/antlr/kotlin/antlr-<wbr>gen/<wbr>Kotlin<wbr>Parser<wbr>Visitor"</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="http://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>